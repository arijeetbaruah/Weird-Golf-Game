<!--
***********************************************************************************************
SCE.MakefileBuild.ClangSA.targets

WARNING:  DO NOT MODIFY this file unless you are knowledgeable about MSBuild and have
          created a backup copy.  Incorrect changes to this file will make it
          impossible to load or build your projects from the command-line or the IDE.
***********************************************************************************************
-->

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Import Project="$(VCTargetsPath)\Platforms\ORBIS\SCE.ClangStaticAnalysis.orbis.targets"/>

  <Target Name="NMakeClangAnalyzeCommandLine">
    <Message Condition="'$(NMakeClangAnalyzeCommandLine)'==''" Text="Provide the property '%24(NMakeClangAnalyzeCommandLine)' with a command line that creates your project's .plist files." Importance="High" />
    <Exec Command="$(NMakeClangAnalyzeCommandLine)" Condition="'$(NMakeClangAnalyzeCommandLine)'!=''" />
  </Target>

  <Target Name="CreateClangAnalyzePlist">
    <PropertyGroup>
      <PlistDir Condition="'$(PlistDir)'==''">$(ProjectDir)</PlistDir>
    </PropertyGroup>

    <CreateItem Include="$(PlistDir)\*.plist" Condition="'$(PlistDir)'!=''">
      <Output TaskParameter="Include" ItemName="ClangAnalyzePlist" />
    </CreateItem>
  </Target>

  <Target Name="Rebuild" DependsOnTargets="PrepareForNMakeBuild">
    <CallTarget Targets="NMakeClangAnalyzeCommandLine;CreateClangAnalyzePlist;CollectClangAnalysisResults" />
  </Target>
  
</Project>