<!--
***********************************************************************************************
Microsoft.CppCommon.orbis.targets

WARNING:  DO NOT MODIFY this file unless you are knowledgeable about MSBuild and have
          created a backup copy.  Incorrect changes to this file will make it
          impossible to load or build your projects from the command-line or the IDE.
***********************************************************************************************
-->

<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!-- *******************************************************************************************
        Lib
       ******************************************************************************************* -->

  <UsingTask TaskName="OrbisSnarl" AssemblyFile="$(VCTargetsPath)Platforms\ORBIS\SCE.Build.CppTasks.orbis.dll" />

  <Target Name="Lib"
          Condition="'@(Lib)' != ''">

    <PropertyGroup>
      <LibToolArchitecture Condition="'$(LibToolArchitecture)' == ''">Native64Bit</LibToolArchitecture>
    </PropertyGroup>

    <ItemGroup>
      <Lib>
        <MinimalRebuildFromTracking Condition="'%(Lib.MinimalRebuildFromTracking)' == '' and '$(BuildType)' == 'Build' and '$(ForceRebuild)' != 'true'">true</MinimalRebuildFromTracking>
        <LinkYieldDuringToolExecution Condition="'$(LinkYieldDuringToolExecution)' == ''">false</LinkYieldDuringToolExecution>
      </Lib>
    </ItemGroup>

    <ItemGroup>
      <LibNoDependencies Condition="'$(NoDependencies)' != ''" Include="$(NoDependencies)" />
    </ItemGroup>

    <OrbisSnarl
        Sources                        ="@(Lib)"
        OutputFile                     ="%(Lib.OutputFile)"
        AdditionalDependencies         ="%(Lib.AdditionalDependencies)"
        DisableWarnings                ="%(Lib.DisableWarnings)"
        ThinArchive                    ="%(Lib.ThinArchive)"
        AdditionalOptions              ="$(LibAdditionalOptions)"      
        
        TrackerLogDirectory            ="%(Lib.TrackerLogDirectory)"
        TLogReadFiles                  ="@(LIBTLogReadFiles)"
        TLogWriteFiles                 ="@(LIBTLogWriteFiles)"
        ToolExe                        ="$(LIBToolExe)"
        ToolPath                       ="$(LIBToolPath)"
        TrackFileAccess                ="$(TrackFileAccess)"
        MinimalRebuildFromTracking     ="%(Lib.MinimalRebuildFromTracking)"
        ToolArchitecture               ="$(LibToolArchitecture)"
        TrackerFrameworkPath           ="$(LibTrackerFrameworkPath)"
        TrackerSdkPath                 ="$(LibTrackerSdkPath)"
        TrackedInputFilesToIgnore      ="@(LibNoDependencies)"

        AcceptableNonZeroExitCodes     ="%(Lib.AcceptableNonZeroExitCodes)"
        YieldDuringToolExecution       ="$(LinkYieldDuringToolExecution)"

        PlatformToolset                ="$(PlatformToolset)"
    >
    </OrbisSnarl>

    <Message Text="$(MSBuildProjectFile) -&gt; $(TargetPath)" Importance="High" />
  </Target>

  <Target Name="ImpLib"
          Condition="'@(ImpLib)' != ''">
    <Message Text="@(ImpLib)"/>
  </Target>
  
  <!-- *******************************************************************************************
        Disable targets for item types we don't want that have been added in AvailableItemName group
       ******************************************************************************************* -->

  <Target Name="Midl" />
  <Target Name="ResourceCompile" />
  <Target Name="ResGen" />
  <Target Name="Xsd" />
  <Target Name="FxCompile" />

  <Import Project="$(VCTargetsPath)\Platforms\ORBIS\Microsoft.CppBuild.orbis.targets"/>
</Project>
